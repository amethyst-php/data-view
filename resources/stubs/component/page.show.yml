label: {{ name }}
extends: data-view-page-show
permissions: 
  - {{ name }}.show
icon: /assets/amethyst/{{ name }}-icon.svg
options:
  data: {{ name }}
  api: {{ api }}
  components:
    main: 
      extends: {{ name }}-resource-show
{% for relation in relations %}{% if relation.type == 'HasMany' or relation.type == 'MorphMany' %}

    {{ relation.key }}:
      extends: {{ relation.data }}-resource-index
      options:
        components:
          {{ relation.foreignKey }}:
            name: {{ relation.foreignKey }}
            include: {{ relation.data }}.components.{{ relation.foreignKey }}
            fixed: "${parent.id}"

{% for scope in relation.scope %}
          
          {{ scope.column }}:
            name: {{ scope.column }}
            include: {{ relation.data }}.components.{{ scope.column }}

            {% if scope.value is iterable %}
            
            fixed: 

              {% for val in scope.value %}
              - "{{ val }}"
              {% endfor %}

            {% else %}
            
            fixed: "{{ scope.value }}"
            
            {% endif %}

{% endfor %}
{% endif %}
{% if relation.type == 'HasOne' or relation.type == 'MorphOne' %}

    {{ relation.key }}:
      extends: {{ relation.data }}-resource-show-or-create
      options:
        extractor: {{ relation.key }}
        components:
          {{ relation.foreignKey }}:
            name: {{ relation.foreignKey }}
            include: {{ relation.data }}.components.{{ relation.foreignKey }}
            fixed: "${parent.id}"

{% for scope in relation.scope %}
          
          {{ scope.column }}:
            name: {{ scope.column }}
            include: {{ relation.data }}.components.{{ scope.column }}

            {% if scope.value is iterable %}
            
            fixed: 

              {% for val in scope.value %}
              - "{{ val }}"
              {% endfor %}

            {% else %}
            
            fixed: "{{ scope.value }}"
            
            {% endif %}

{% endfor %}
{% endif %}
{% endfor %}